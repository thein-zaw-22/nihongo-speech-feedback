{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}AI Japanese Feedback{% endblock %}</title>
  <style>
    :root {
      --brand: #667eea;
      --brand-2: #764ba2;
      --bg-primary: #ffffff;
      --bg-secondary: rgba(247, 250, 252, 0.8);
      --text-primary: #2d3748;
      --text-secondary: #4a5568;
      --text-muted: #718096;
      --border-color: #e2e8f0;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 10px 25px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    [data-theme="dark"] {
      --bg-primary: #1a202c;
      --bg-secondary: rgba(45, 55, 72, 0.8);
      --text-primary: #f7fafc;
      --text-secondary: #e2e8f0;
      --text-muted: #a0aec0;
      --border-color: #4a5568;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 10px 25px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.5);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: linear-gradient(135deg, var(--brand) 0%, var(--brand-2) 100%); min-height: 100vh; color: var(--text-primary); transition: all 0.3s ease; }
    .nav { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); }
    .nav .row { max-width: 1200px; margin: 0 auto; padding: 0.5rem 1rem; display: flex; align-items: center; gap: 0.5rem; min-height: 50px; }
    .brand { font-weight: 700; font-size: 1rem; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .actions { margin-left: auto; display: flex; align-items: center; gap: 0.375rem; }
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:.4rem; padding:.35rem .6rem; border:none; border-radius:8px; font-size:.8rem; font-weight:600; cursor:pointer; text-decoration:none; transition: all .2s ease; }
    .btn-primary { background: linear-gradient(135deg, var(--brand), var(--brand-2)); color:#fff; box-shadow: 0 2px 8px rgba(102,126,234,.3); }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(102,126,234,.4); }
    .btn-secondary { background: rgba(102,126,234,.1); color: var(--brand); border: 1px solid rgba(102,126,234,.25); }
    .btn-secondary:hover { background: rgba(102,126,234,.2); }
    .container { max-width: 1000px; margin: 1.5rem auto; padding: 2rem; background: var(--bg-primary); backdrop-filter: blur(10px); border-radius: 20px; box-shadow: var(--shadow-lg); border: 1px solid var(--border-color); transition: all 0.3s ease; }
    .theme-select {
      padding: .35rem .6rem;
      border: 1px solid rgba(102,126,234,.25);
      border-radius: 8px;
      background: rgba(102,126,234,.1);
      color: var(--brand);
      font-size: .8rem;
      font-weight: 600;
      line-height: 1;
    }
    .theme-select:hover { background: rgba(102,126,234,.2); cursor: pointer; }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="row">
      <div class="brand">ðŸŽ¯ AI Feedback</div>
      <div class="actions">
        {% if user.is_authenticated %}
          <a class="btn btn-secondary" href="/">Home</a>
          <form action="{% url 'logout' %}" method="post" style="display:inline; margin:0;">
            {% csrf_token %}
            <button type="submit" class="btn btn-secondary" style="cursor:pointer;">Logout</button>
          </form>
        {% else %}
          {% with view_name=request.resolver_match.url_name %}
            {% if view_name != 'login' and view_name != 'signup' %}
              <a class="btn btn-secondary" href="{% url 'login' %}">Login</a>
              <a class="btn btn-secondary" href="{% url 'signup' %}">Register</a>
            {% endif %}
          {% endwith %}
        {% endif %}
        <select id="themeSelect" class="theme-select" aria-label="Theme">
          <option value="system">Auto</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </div>
    </div>
  </nav>

  <main class="container">
    {% if messages %}
      <div class="messages" style="margin-bottom:1rem;">
        {% for message in messages %}
          <div class="message" style="padding:.75rem 1rem; border-radius:10px; background: rgba(72,187,120,.12); color:#2f855a; border-left:4px solid #48bb78; margin-bottom:.5rem;">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
    {% block content %}{% endblock %}
  </main>

  <script>
    // Simple theme toggle persistence
    const root = document.documentElement;
    const themeSelect = document.getElementById('themeSelect');
    const saved = localStorage.getItem('theme');
    if (saved && saved !== 'system') root.setAttribute('data-theme', saved);
    function syncSelect() { const attr = root.getAttribute('data-theme'); themeSelect.value = attr ? attr : 'system'; }
    syncSelect();
    themeSelect.addEventListener('change', () => {
      const val = themeSelect.value;
      if (val === 'system') { root.removeAttribute('data-theme'); localStorage.removeItem('theme'); }
      else { root.setAttribute('data-theme', val); localStorage.setItem('theme', val); }
      syncSelect();
    });
  </script>
</body>
</html>
